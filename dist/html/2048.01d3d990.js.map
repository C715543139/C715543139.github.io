{"mappings":"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","sources":["script/2048.js"],"sourcesContent":["/* This implement is convert from C. */\r\nconst MAP_SIZE = 4;\r\nconst SWAP = (x, y) => [y, x]\r\n\r\nlet g_map = Array.from({length: MAP_SIZE + 2}, () => Array(MAP_SIZE + 2).fill(0));\r\n\r\nfunction RandNumber(max) {\r\n    const minCeiled = 0;\r\n    const maxFloored = Math.floor(max);\r\n    return Math.floor(Math.random() * (maxFloored - minCeiled) + minCeiled);\r\n}\r\n\r\nfunction NewBlock() {\r\n    let freeBlock = [];\r\n    for (let y = 1; y <= MAP_SIZE; y++) {\r\n        for (let x = 1; x <= MAP_SIZE; x++) {\r\n            if (g_map[y][x] === 0) freeBlock.push([y, x]);\r\n        }\r\n    }\r\n    if (freeBlock.length === 0) return;\r\n    let [y, x] = freeBlock[RandNumber(freeBlock.length)];\r\n    g_map[y][x] = RandNumber(10) === 5 ? 4 : 2;\r\n}\r\n\r\nfunction Initiate() {\r\n    NewBlock();\r\n    NewBlock();\r\n}\r\n\r\nfunction Push(flag) {\r\n    let change = false;\r\n    let UP = flag === \"ArrowUp\", DOWN = flag === \"ArrowDown\", LEFT = flag === \"ArrowLeft\";\r\n    for (let x = 1; x <= MAP_SIZE; ++x) {\r\n        for (let y = (UP || LEFT ? 1 : MAP_SIZE); (UP || LEFT ? (y < MAP_SIZE) : (y > 1)); UP || LEFT ? y++ : y--) {\r\n            if (g_map[UP || DOWN ? y : x][UP || DOWN ? x : y] === 0) {\r\n                let i = (UP || LEFT ? (y + 1) : (y - 1));\r\n                while ((UP || LEFT ? (i <= MAP_SIZE) : (i > 0)) && g_map[UP || DOWN ? i : x][UP || DOWN ? x : i] === 0) UP || LEFT ? i++ : i--;\r\n                if ((UP || LEFT ? (i <= MAP_SIZE) : (i > 0))) {\r\n                    change = true;\r\n                    [g_map[UP || DOWN ? y : x][UP || DOWN ? x : y], g_map[UP || DOWN ? i : x][UP || DOWN ? x : i]]\r\n                        = SWAP(g_map[UP || DOWN ? y : x][UP || DOWN ? x : y], g_map[UP || DOWN ? i : x][UP || DOWN ? x : i])\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return change;\r\n}\r\n\r\nfunction Merge(flag) {\r\n    let change = false;\r\n    let UP = flag === \"ArrowUp\", DOWN = flag === \"ArrowDown\", LEFT = flag === \"ArrowLeft\";\r\n    if (UP || DOWN) {\r\n        for (let x = 1; x <= MAP_SIZE; ++x) {\r\n            for (let y = (UP ? 1 : MAP_SIZE); (UP ? (y < MAP_SIZE) : (y > 0)); UP ? y++ : y--) {\r\n                if (g_map[y][x] === g_map[UP ? (y + 1) : (y - 1)][x] && g_map[y][x] !== 0) {\r\n                    change = true;\r\n                    g_map[y][x] *= 2;\r\n                    g_map[UP ? (y + 1) : (y - 1)][x] = 0;\r\n                }\r\n            }\r\n        }\r\n    } else {\r\n        for (let y = 1; y <= MAP_SIZE; ++y) {\r\n            for (let x = (LEFT ? 1 : MAP_SIZE); (LEFT ? (x < MAP_SIZE) : (x > 0)); LEFT ? x++ : x--) {\r\n                if (g_map[y][x] === g_map[y][LEFT ? (x + 1) : (x - 1)] && g_map[y][x] !== 0) {\r\n                    change = true;\r\n                    g_map[y][x] *= 2;\r\n                    g_map[y][LEFT ? (x + 1) : (x - 1)] = 0;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return change;\r\n}\r\n\r\nfunction Check() {\r\n    for (let y = 1; y <= MAP_SIZE; ++y) {\r\n        for (let x = 1; x <= MAP_SIZE; ++x) {\r\n            if (g_map[y][x] === g_map[y - 1][x] || g_map[y][x] === g_map[y + 1][x] ||\r\n                g_map[y][x] === g_map[y][x - 1] || g_map[y][x] === g_map[y][x + 1] ||\r\n                g_map[y][x] === 0) {\r\n                return true;\r\n            }\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nfunction PrintMap() {\r\n    for (let y = 1; y <= MAP_SIZE; ++y) {\r\n        for (let x = 1; x <= MAP_SIZE; ++x) {\r\n            let block = document.getElementById(String((y - 1) * MAP_SIZE + x - 1));\r\n            block.innerText = g_map[y][x] === 0 ? \"\" : g_map[y][x];\r\n        }\r\n    }\r\n}\r\n\r\n/* main */\r\nInitiate();\r\nPrintMap();\r\ndocument.addEventListener(\"keydown\", (event)=>{\r\n    let op = event.key;\r\n    if (op === \"ArrowUp\" || op === \"ArrowDown\" || op === \"ArrowLeft\" || op === \"ArrowRight\") {\r\n        event.preventDefault();\r\n        let change;\r\n        change = Push(op);\r\n        change = Merge(op) || change;\r\n        change = Push(op) || change;\r\n\r\n        change ? NewBlock() : null;\r\n        PrintMap();\r\n\r\n        if (!Check()) {\r\n            alert(\"GAME OVER!\");\r\n            location.reload();\r\n        }\r\n    }\r\n})"],"names":[],"version":3,"file":"2048.01d3d990.js.map","sourceRoot":"/__parcel_source_root/"}